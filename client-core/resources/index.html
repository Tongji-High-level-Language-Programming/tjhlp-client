<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Qt Hybrid Verify</title>
    <style>
      body {
        font-family: sans-serif;
        text-align: center;
        padding: 50px;
        background: #f0f0f0;
      }
      h1 {
        color: #41cd52;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
      #log {
        margin-top: 20px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <h1>System Status: Ready</h1>
    <p>如果能看到这个页面，说明 Qt WebEngine 工作正常。</p>

    <button onclick="testConnection()">点击测试 C++ 连接</button>
    <p id="log">等待操作...</p>

    <script src="qwebchannel.js"></script>

    <script>
      var core = null; // 用于存储 C++ 对象

      // 1. 初始化 WebChannel
      new QWebChannel(qt.webChannelTransport, function (channel) {
        // 获取在 C++ 中 registerObject 的对象 "core"
        core = channel.objects.core;
        document.getElementById("log").innerText = "C++ Bridge Connected!";
      });

      // 2. 按钮点击事件
      function testConnection() {
        if (!core) {
          alert("WebChannel 未连接！");
          return;
        }

        // 调用 C++ 方法 showMessage (无返回值)
        core.showMessage("Hello from Web Interface!");

        // 调用 C++ 方法 getSystemTime (有返回值)
        core.getSystemTime(function (returnValue) {
          document.getElementById("log").innerText =
            "Server Time: " + returnValue;
        });
      }
    </script>
  </body>
</html>
